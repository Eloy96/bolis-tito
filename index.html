<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¡Bolis Artesanales - La Alegría Refrescante!</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Swiper JS (para carrusel de reseñas) -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <script>
      // Configuramos Tailwind para usar Quicksand como fuente principal
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Quicksand', 'sans-serif'],
            },
            keyframes: {
              bounceIn: {
                '0%, 20%, 40%, 60%, 80%, 100%': { transform: 'translateY(0)' },
                '50%': { transform: 'translateY(-10px)' },
              },
              fadeInUp: {
                '0%': { opacity: 0, transform: 'translateY(20px)' },
                '100%': { opacity: 1, transform: 'translateY(0)' },
              },
              /* Animación de flotación suave */
              'float-light': {
                '0%, 100%': { transform: 'translateY(0px)' }, 
                '50%': { transform: 'translateY(-8px)' },
              },
              /* Animación para el gradiente del título */
              'text-gradient-anim': {
                '0%': { 'background-position': '0% 50%' },
                '50%': { 'background-position': '100% 50%' },
                '100%': { 'background-position': '0% 50%' },
              }
            },
            animation: {
              'bounce-in': 'bounceIn 1s ease-out infinite',
              'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
              'float-light': 'float-light 4s ease-in-out infinite',
              /* Animación para el gradiente del título */
              'text-gradient-anim': 'text-gradient-anim 4s ease-in-out infinite',
            }
          }
        }
      }
    </script>
    <style>
      body {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: linear-gradient(to bottom right, #FFC107, #FF8A65, #FF5722); /* Degradado más alegre */
        background-attachment: fixed; /* Para que el degradado se mantenga al hacer scroll */
        overflow-x: hidden; /* ¡Esto elimina el scroll horizontal! */
      }
      
      /* Keyframes para la animación del título */
      @keyframes text-gradient-anim {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      /* Clase para el gradiente animado del título */
      .text-gradient-animated {
        background-image: linear-gradient(to right, #ffffff 20%, #fde047 50%, #ffffff 80%);
        background-size: 200% auto;
        color: transparent;
        background-clip: text;
        -webkit-background-clip: text;
      }

      .card-icon {
        /* Usamos 'contain' para que la imagen completa quepa sin cortarse */
        width: 100%;
        height: 100%;
        object-fit: contain; /* Esto asegura que la imagen se escala para caber completamente */
        transition: transform 0.3s ease-in-out;
        padding: 5px; /* Pequeño padding para que no se pegue al borde del círculo si es muy ancha */
      }
      
      .card-product:hover .card-icon {
        transform: scale(1.05) rotate(0deg); 
      }
      .card-product:hover .card-icon-container {
         box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* group-hover:shadow-xl */
      }
      .card-product {
        animation: fadeInUp 0.8s ease-out forwards;
        opacity: 0; /* Empieza oculto para la animación */
      }
      /* Animación de retraso para las tarjetas */
      .card-product:nth-child(1) { animation-delay: 0.1s; }
      .card-product:nth-child(2) { animation-delay: 0.2s; }
      .card-product:nth-child(3) { animation-delay: 0.3s; }
      .card-product:nth-child(4) { animation-delay: 0.4s; }
      .card-product:nth-child(5) { animation-delay: 0.5s; }
      /* ---- REGLA ACTUALIZADA (AHORA ES MANGO) ---- */
      .card-product:nth-child(6) { animation-delay: 0.6s; }
      /* ---- NUEVA REGLA (ZARZAMORA) ---- */
      .card-product:nth-child(7) { animation-delay: 0.7s; }
      /* ---- NUEVA REGLA (GUAYABA) ---- */
      .card-product:nth-child(8) { animation-delay: 0.8s; }


      /* --- Estilos para el formulario y reseñas --- */
      .form-label {
        font-weight: 700;
        color: #374151; /* text-gray-700 */
        margin-bottom: 0.5rem; /* mb-2 */
        display: block;
      }
      .form-input, .form-select, .form-textarea {
        width: 100%;
        padding: 0.75rem; /* p-3 */
        border: 1px solid #D1D5DB; /* border-gray-300 */
        border-radius: 0.75rem; /* rounded-xl */
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
        transition: border-color 0.2s, box-shadow 0.2s;
      }
      .form-input:focus, .form-select:focus, .form-textarea:focus {
        outline: none;
        border-color: #F97316; /* border-orange-500 */
        box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.3); /* ring-orange-500 */
      }
      /* Estilos para el Rating de Estrellas */
      .star-rating {
        display: flex;
        flex-direction: row-reverse;
        justify-content: center;
        gap: 0.25rem; /* gap-1 */
      }
      .star-rating input[type="radio"] {
        display: none;
      }
      .star-rating label {
        font-size: 2.25rem; /* text-4xl */
        color: #D1D5DB; /* text-gray-300 */
        cursor: pointer;
        transition: color 0.2s;
      }
      .star-rating input[type="radio"]:checked ~ label {
        color: #FBBF24; /* text-amber-400 */
      }
      .star-rating label:hover,
      .star-rating label:hover ~ label {
        color: #FBBF24; /* text-amber-400 */
      }
      /* Mensaje de éxito/error (no usamos alert) */
      .form-message {
        display: none;
        padding: 1rem;
        margin-top: 1rem;
        border-radius: 0.75rem;
        font-weight: 600;
      }
      .form-message.success {
        display: block;
        background-color: #D1FAE5; /* bg-green-100 */
        color: #065F46; /* text-green-800 */
      }
      .form-message.error {
        display: block;
        background-color: #FEE2E2; /* bg-red-100 */
        color: #991B1B; /* text-red-800 */
      }

      /* --- NUEVO: Estilos para etiquetas de producto --- */
      .product-label {
        position: absolute;
        top: 0.75rem; /* 12px */
        right: 0.75rem; /* 12px */
        padding: 0.25rem 0.75rem; /* py-1 px-3 */
        border-radius: 9999px; /* rounded-full */
        font-size: 0.75rem; /* text-xs */
        font-weight: 700; /* font-bold */
        color: white;
        text-transform: uppercase;
        z-index: 10;
      }
      .label-popular {
        background-color: #EF4444; /* bg-red-500 */
      }
      .label-new {
        background-color: #22C55E; /* bg-green-500 */
      }

      /* --- CAMBIOS EN EL CARRUSEL --- */
      .swiper-container {
        width: 100%;
        padding-bottom: 50px !important; /* Más espacio para puntos */
        touch-action: pan-y; /* Previene el 'swipe' de navegación del navegador en móviles */
        overflow: hidden !important; /* Previene que se vean slides cortados */
      }
      .swiper-slide {
        box-sizing: border-box; /* Asegura que el padding no rompa el diseño */
      }
      
      .swiper-pagination-bullet-active {
        background-color: #F97316 !important; /* Color naranja para el punto activo */
      }
      /* Estilos para las flechas de navegación */
      .swiper-button-next,
      .swiper-button-prev {
        color: #FFFFFF !important; /* Color blanco */
        background-color: rgba(0, 0, 0, 0.2); /* Fondo semitransparente */
        width: 44px !important;
        height: 44px !important;
        border-radius: 9999px; /* Círculo */
        transition: background-color 0.2s;
      }
      .swiper-button-next:hover,
      .swiper-button-prev:hover {
        background-color: rgba(0, 0, 0, 0.4); /* Más oscuro al pasar el mouse */
      }
      .swiper-button-next:after,
      .swiper-button-prev:after {
        font-size: 20px !important; /* Tamaño del icono de flecha */
        font-weight: 900 !important;
      }

      /* Regla para evitar el scroll del body cuando el modal está abierto */
      body.modal-open {
        overflow: hidden;
      }
      /* Aseguramos que el modal en sí pueda scrollear internamente */
      #cart-modal {
        overflow-y: auto;
      }
      
      /* Estilos para el mensaje "Toast" de éxito (ELIMINADO) */
     
    </style>
</head>
<body class="font-sans">

    <!-- Contenedor del Mensaje "Toast" (ELIMINADO) -->
    
    <!-- Contenedor Principal -->
    <div class="container mx-auto px-4 py-12 md:py-20 relative"> <!-- Añadido relative para el icono de carrito -->

        <!-- Icono de Carrito -->
        <!-- Ajustado 'top-4' porque el banner se fue -->
        <div id="cart-icon" class="fixed top-4 right-4 z-40 cursor-pointer p-3 bg-white rounded-full shadow-lg hover:bg-gray-100 transition">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-orange-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
            <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold rounded-full h-6 w-6 flex items-center justify-center">0</span>
        </div>

        
        <!-- Encabezado -->
        <header class="text-center mb-16 md:mb-24">
            <!-- Título sin Emoji -->
            <!-- Título más pequeño en móvil (text-4xl) -->
            <h1 class="text-4xl md:text-7xl font-extrabold mb-4 leading-tight text-gradient-animated animate-text-gradient-anim">
                ¡Bolis Artesanales! <br> El sabor de la alegría
            </h1>
            <p class="text-xl md:text-3xl text-yellow-100 font-medium drop-shadow-md">
                Refresca tu día con nuestros deliciosos y cremosos bolis.
            </p>
            <!-- Botón "¡Quiero uno ya!" ELIMINADO -->
        </header>

        
        <!-- Sección de Productos -->
        <!-- 'grid-cols-2' (para móvil), 'lg:grid-cols-3' (para desktop) -->
        <!-- Ajustado gap-x y pt para las nuevas tarjetas cuadradas -->
        <!-- Ahora tenemos 8 productos -->
        <main class="grid grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-8 pt-8 max-w-7xl mx-auto">

            
            <!-- 1. Tamarindo (ACTUALIZADO) -->
            <div class="card-product">
                <!-- Padding normal, quitado pt-16 -->
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-popular">Más Comprado</span>
                    
                    <!-- Contenedor de imagen CUADRADO, DENTRO del flujo -->
                    <div class="bg-orange-200 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/tamarindo.png" alt="Boli de Tamarindo" class="card-icon" onerror="this.src='https://placehold.co/400x400/D32F2F/FFFFFF?text=Tamarindo'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <!-- Título sin padding-top extra -->
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Tamarindo</h3>
                        <!-- Descripción más pequeña (text-sm) -->
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Pulpa de tamarindo 100% natural y un toque de sal.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <!-- Precio más pequeño (text-4xl) -->
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Tamarindo" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            
            <!-- 2. Mazapán -->
            <div class="card-product">
                <!-- Padding normal, quitado pt-16 -->
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-new">Nuevo</span>
                    
                    <!-- Contenedor de imagen CUADRADO, DENTRO del flujo -->
                    <div class="bg-yellow-100 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/bolis-mazapan.png" alt="Boli de Mazapán" class="card-icon" onerror="this.src='https://placehold.co/400x400/FBC02D/795548?text=Mazap%C3%A1n'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <!-- Título sin padding-top extra -->
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Mazapán</h3>
                        <!-- Descripción más pequeña (text-sm) -->
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Mazapán de cacahuate original, leche cremosa y un toque de vainilla.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <!-- Precio más pequeño (text-4xl) -->
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Mazapán" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            
            <!-- 3. Rompope (en lugar de Horchata) -->
            <div class="card-product">
                <!-- Padding normal, quitado pt-16 -->
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-popular">Más Comprado</span>
                    
                    <!-- Contenedor de imagen CUADRADO, DENTRO del flujo -->
                    <div class="bg-amber-100 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/bolis-rompope.png" alt="Boli de Rompope" class="card-icon" onerror="this.src='https://placehold.co/400x400/FCE68A/D3890D?text=Rompope'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <!-- Título sin padding-top extra -->
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Rompope</h3>
                        <!-- Descripción más pequeña (text-sm) -->
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Cremosa base de leche con el sabor tradicional del rompope marca Coronado.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <!-- Precio más pequeño (text-4xl) -->
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Rompope" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            
            <!-- 4. Fresas con Crema -->
            <div class="card-product">
                <!-- Padding normal, quitado pt-16 -->
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-popular">Más Comprado</span>
                    
                    <!-- Contenedor de imagen CUADRADO, DENTRO del flujo -->
                    <div class="bg-pink-200 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/bolis-fresas-con-crema.png" alt="Boli de Fresas con Crema" class="card-icon" onerror="this.src='https://placehold.co/400x400/F8BBD0/C2185B?text=Fresas%0ACon+Crema'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <!-- Título sin padding-top extra -->
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Fresas con Crema</h3>
                        <!-- Descripción más pequeña (text-sm) -->
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Fresas frescas de temporada, crema dulce, leche evaporada y un toque de lechera.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <!-- Precio más pequeño (text-4xl) -->
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Fresas con Crema" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            
            <!-- 5. Oreo -->
            <div class="card-product">
                <!-- Padding normal, quitado pt-16 -->
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-popular">Más Comprado</span>
                    
                    <!-- Contenedor de imagen CUADRADO, DENTRO del flujo -->
                    <div class="bg-gray-700 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/bolis-de-oreo.png" alt="Boli de Oreo" class="card-icon" onerror="this.src='https://placehold.co/400x400/424242/FFFFFF?text=Oreo'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <!-- Título sin padding-top extra -->
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Oreo</h3>
                        <!-- Descripción más pequeña (text-sm) -->
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Galleta Oreo triturada, leche entera, crema dulce y un toque de vainilla.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <!-- Precio más pequeño (text-4xl) -->
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Oreo" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>
            

            <!-- 6. NUEVO: Mango con Crema -->
            <div class="card-product">
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-new">Nuevo</span>
                    
                    <!-- Contenedor de imagen -->
                    <div class="bg-orange-100 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <!-- Te sugiero usar un placeholder si aún no tienes la imagen, o poner la ruta que usarás -->
                        <img src="imagenes/mango-con-crema.png" alt="Boli de Mango con Crema" class="card-icon" onerror="this.src='https://placehold.co/400x400/FFD180/E65100?text=Mango%0ACon+Crema'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Mango con Crema</h3>
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Mango fresco de temporada, crema dulce y un toque de lechera.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Mango con Crema" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            <!-- 7. NUEVO: Zarzamora con Crema -->
            <div class="card-product">
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-new">Nuevo</span>
                    
                    <!-- Contenedor de imagen -->
                    <div class="bg-purple-200 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <!-- Te sugiero usar un placeholder si aún no tienes la imagen, o poner la ruta que usarás -->
                        <img src="imagenes/zarzamora-con-crema.png" alt="Boli de Zarzamora con Crema" class="card-icon" onerror="this.src='https://placehold.co/400x400/E1BEE7/6A1B9A?text=Zarzamora%0ACon+Crema'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Zarzamora con Crema</h3>
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Zarzamoras frescas, crema dulce, leche y un toque de vainilla.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <!-- Selector de cantidad y botón "Agregar" -->
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Zarzamora con Crema" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>

            <!-- 8. NUEVO: Guayaba de Agua -->
            <div class="card-product">
                <div class="bg-white rounded-3xl shadow-2xl p-4 text-center relative h-full flex flex-col transform hover:scale-105 transition-transform duration-300 ease-in-out group">
                    <span class="product-label label-new">Nuevo</span>
                    <!-- Contenedor de imagen -->
                    <div class="bg-lime-200 w-full aspect-square rounded-xl shadow-lg border-6 border-white flex items-center justify-center overflow-hidden mb-4">
                        <img src="imagenes/guayaba.png" alt="Boli de Guayaba de Agua" class="card-icon" onerror="this.src='https://placehold.co/400x400/D4E157/7E553A?text=Guayaba%0Ade+Agua'; this.onerror=null;">
                    </div>
                    
                    <!-- Contenido -->
                    <div class="flex-grow">
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">Guayaba de Agua</h3>
                        <p class="text-gray-600 text-sm mb-4">
                            Ingredientes: Guayaba fresca, agua purificada y un toque de azúcar.
                        </p>
                    </div>
                    
                    <!-- Precio y Botón -->
                    <div class="mt-4 flex flex-col items-center">
                        <span class="text-4xl font-extrabold text-orange-600 block mb-1">$12</span>
                        <span class="text-sm font-medium text-gray-500 block mb-3">133 ml</span>
                        <div class="flex items-center gap-2 mt-4">
                            <input type="number" class="product-quantity w-16 text-center form-input py-2" value="1" min="1">
                            <button class="add-to-cart-btn bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold py-2 px-3 rounded-full shadow-md hover:shadow-lg transform hover:scale-105 transition duration-300 ease-in-out text-sm" data-sabor="Guayaba de Agua" data-precio="12">
                                Agregar
                            </button>
                        </div>
                        <span class="add-to-cart-message text-green-600 h-4 mt-1 text-xs font-medium"></span>
                    </div>
                </div>
            </div>
            
        </main>

        
        <!-- Sección de Reseñas -->
        <section id="reseñas" class="mt-24 pt-16">
          <div class="w-full max-w-3xl mx-auto">
            <h2 class="text-4xl font-extrabold text-center text-white mb-8 drop-shadow-lg">¡Lo que dicen nuestros clientes!</h2>

            
            <!-- Carrusel de Reseñas -->
            <!-- Añadido 'relative' para posicionar flechas -->
            <div class="relative">
              <div class="swiper-container mySwiper mb-12">
                <div class="swiper-wrapper">
                  
                  
                  <!-- Reseña Estática 1 -->
                  <div class="swiper-slide bg-white p-6 rounded-2xl shadow-xl">
                    <div class="flex justify-between items-center mb-2">
                      <span class="font-bold text-lg text-gray-800">Laura G.</span>
                      <span class="text-amber-400 text-xl">★★★★★</span>
                    </div>
                    <p class="text-gray-600">"¡El boli de Oreo es espectacular! Súper cremoso y con muchos trocitos de galleta. 100% recomendado."</p>
                  </div>
                  
                  
                  <!-- Reseña Estática 2 -->
                  <div class="swiper-slide bg-white p-6 rounded-2xl shadow-xl">
                    <div class="flex justify-between items-center mb-2">
                      <span class="font-bold text-lg text-gray-800">Miguel R.</span>
                      <span class="text-amber-400 text-xl">★★★★☆</span>
                    </div>
                    <!-- Cambié "horchata" por "rompope" en la reseña estática para que tenga sentido -->
                    <p class="text-gray-600">"Muy rico el de Fresas con Crema, se nota que la fresa es natural. El de rompope también muy bueno. Me gustaría que tuvieran de limón."</p>
                  </div>
                  
                  
                  <!-- Reseña Estática 3 -->
                  <div class="swiper-slide bg-white p-6 rounded-2xl shadow-xl">
                    <div class="flex justify-between items-center mb-2">
                      <span class="font-bold text-lg text-gray-800">Sofía M.</span>
                      <span class="text-amber-400 text-xl">★★★★★</span>
                    </div>
                    <p class="text-gray-600">"Excelente servicio, me contactaron rápido por WhatsApp y la entrega fue súper puntual en el kiosko. ¡Gracias!"</p>
                  </div>

                </div>
                
                <!-- Paginación del Carrusel -->
                <div class="swiper-pagination"></div>
              </div>

              <!-- Flechas de Navegación Añadidas -->
              <div class="swiper-button-prev -left-2"></div>
              <div class="swiper-button-next -right-2"></div>
            </div>


            
            <!-- Formulario para dejar Reseña -->
            <div class="bg-white p-6 md:p-10 rounded-3xl shadow-2xl animate-fade-in-up" style="animation-delay: 0.9s;">
              <h3 class="text-3xl font-bold text-center text-gray-800 mb-6">¡Deja tu reseña!</h3>
              <form id="reviewForm">
                <div class="mb-4">
                  <!-- Texto más claro para las estrellas -->
                  <label class="form-label text-center">¡Tu Calificación! (Elige las estrellas)</label>
                  <div class="star-rating">
                    <input type="radio" id="star5" name="rating" value="5" required><label for="star5" title="5 estrellas">★</label>
                    <input type="radio" id="star4" name="rating" value="4"><label for="star4" title="4 estrellas">★</label>
                    <input type="radio" id="star3" name="rating" value="3"><label for="star3" title="3 estrellas">★</label>
                    <input type="radio" id="star2" name="rating" value="2"><label for="star2" title="2 estrellas">★</label>
                    <input type="radio" id="star1" name="rating" value="1"><label for="star1" title="1 estrella">★</label>
                  </div>
                </div>
                <div class="mb-4">
                  <label for="review-nombre" class="form-label">Tu Nombre</label>
                  <input type="text" id="review-nombre" name="review-nombre" class="form-input" required>
                </div>
                <div class="mb-6">
                  <label for="review-comentario" class="form-label">Tu Comentario</label>
                  <textarea id="review-comentario" name="review-comentario" rows="3" class="form-textarea" required placeholder="Cuéntanos tu experiencia..."></textarea>
                </div>
                <button type="submit" id="submit-review-btn" class="w-full bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold text-lg py-4 px-6 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
                  Enviar Reseña
                </button>
                
                <!-- Mensaje de Estado de la Reseña -->
                <div id="review-form-message" class="form-message"></div>
              </form>
            </div>
          </div>
        </section>

        
        <!-- Footer -->
        <footer class="text-center p-8 text-yellow-50 mt-16 drop-shadow-md">
            <!-- Marca "BOLIS TITO" actualizada -->
            <p class="font-extrabold text-2xl mb-2">BOLIS TITO</p>
            <p class="font-bold text-lg">Bolis Artesanales "La Alegría Refrescante" &copy; 2025</p>
            <p>Hechos con ❤️ y mucho sabor en México</p>
        </footer>

    </div>

    <!-- Modal del Carrito de Compras -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-75 z-50 hidden flex items-center justify-center p-4">
      <!-- Modal más responsivo en altura y ancho -->
      <div id="cart-modal-content" class="bg-white w-full max-w-lg rounded-2xl shadow-xl flex flex-col max-h-[90vh]">
          
          <!-- Encabezado del Modal -->
          <div class="flex justify-between items-center p-5 border-b">
            <h2 class="text-3xl font-extrabold text-gray-800">Tu Carrito</h2>
            <button id="close-cart-btn" class="text-gray-400 hover:text-gray-700 text-4xl font-light">&times;</button>
          </div>
          
          <!-- Contenedor de SCROLL ÚNICO -->
          <div class="overflow-y-auto">

            <!-- Contenido del Carrito (Items) -->
            <div id="cart-items-container" class="p-6 space-y-4">
                <!-- Los items del carrito se agregarán aquí con JS -->
                <!-- <p id="cart-empty-message" class="text-gray-500 text-center">Tu carrito está vacío.</p> -->
            </div>
            
            <!-- Total del Carrito -->
            <div class="p-6 border-t text-right">
                <span class="text-3xl font-extrabold text-gray-800">Total: <span id="cart-total" class="text-orange-600">$0.00</span></span>
            </div>
            
            <!-- Formulario de Checkout -->
            <form id="checkoutForm" class="p-6 space-y-4 border-t">
                <h3 class="text-2xl font-bold text-gray-700">Completa tu Pedido</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="nombre" class="form-label">Nombre Completo</label>
                        <input type="text" id="nombre" name="nombre" class="form-input" required>
                    </div>
                    <div>
                        <label for="telefono" class="form-label">Teléfono / WhatsApp</label>
                        <input type="tel" id="telefono" name="telefono" class="form-input" required>
                    </div>
                </div>
                <div class="mb-2">
                    <label for="lugar-entrega" class="form-label">Lugar de Entrega</label>
                    <select id="lugar-entrega" name="lugar-entrega" class="form-select" required>
                        <option value="">Selecciona un punto de entrega...</option>
                        <option value="Huixquilucan Centro (Kiosko)">Huixquilucan Centro (Kiosko)</option>
                        <option value="El Mirador Magdalena Chichicaspa (Parada de autobuses)">El Mirador Magdalena Chichicaspa (Parada)</option>
                        <option value="Paraje Las Máquinas Magdalena Chichicaspa">Paraje Las Máquinas Magdalena Chichicaspa</option>
                        <!-- NUEVA UBICACIÓN -->
                        <option value="Av. Toluca 481">Av. Toluca 481</option>
                    </select>
                    <p class="text-sm text-gray-500 mt-2">
                        <strong>Horario de Entrega:</strong> Sábados, acordando la hora contigo.
                    </p>
                </div>
                <div class="mb-2">
                    <label for="comentarios" class="form-label">Comentarios Adicionales</label>
                    <textarea id="comentarios" name="comentarios" rows="3" class="form-textarea" placeholder="¿Alguna indicación especial?"></textarea>
                </div>

                <!-- Botón de Confirmar Pedido (restaurado) -->
                <button type="submit" id="submit-order-btn" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold text-lg py-4 px-6 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
                    Confirmar Pedido
                </button>
                
                <div id="cart-form-message" class="form-message"></div>
            </form>

          </div> <!-- Fin del contenedor de SCROLL ÚNICO -->

      </div>
    </div>
    
    <!-- NUEVO: Modal de Agradecimiento -->
    <div id="thank-you-modal" class="fixed inset-0 bg-black bg-opacity-75 z-50 hidden flex items-center justify-center p-4">
       <div class="bg-white w-full max-w-md rounded-2xl shadow-xl p-8 text-center relative">
           <!-- Botón de Cerrar (X) -->
           <button id="close-thank-you-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-4xl font-light">&times;</button>
           
           <!-- Icono de Éxito -->
           <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
               <svg class="w-12 h-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
           </div>
           
           <h2 class="text-3xl font-extrabold text-gray-800 mb-4">¡Pedido Recibido!</h2>
           <p class="text-gray-600 text-lg mb-8">¡Gracias por tu compra! Te contactaremos pronto por WhatsApp para confirmar la hora de entrega.</p>
           
           <button id="new-order-btn" class="w-full bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold text-lg py-4 px-6 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
               Hacer otro pedido
           </button>
       </div>
    </div>

    <!-- JavaScript (SCRIPT COMPLETO Y CORREGIDO) -->
    <script>
      // ---- URL de Google Apps Script ----
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx88q2qxy_szNMh4GOz0gT-Bpp7Fz6GOoMo5b2uvwKRoopMARciMQ8JsD-R-6kuldE/exec';
      // --------------------

      // Estado del Carrito
      let cart = [];

      // --- TODO EL CÓDIGO DENTRO DE DOMCONTENTLOADED ---
      document.addEventListener('DOMContentLoaded', () => {
        
        // --- Selectores de Reseñas ---
        const reviewForm = document.getElementById('reviewForm');
        const reviewMessage = document.getElementById('review-form-message');
        const submitReviewBtn = document.getElementById('submit-review-btn');
        
        // --- Configuración del Carrusel de Reseñas ---
        try {
          var swiper = new Swiper(".mySwiper", {
            slidesPerView: 1, 
            spaceBetween: 30, 
            effect: 'fade', 
            fadeEffect: {
              crossFade: true
            },
            loop: true, 
            centeredSlides: true, 
            autoplay: {
              delay: 3000, 
              disableOnInteraction: false, 
            },
            pagination: {
              el: ".swiper-pagination",
              clickable: true, 
            },
            navigation: {
              nextEl: '.swiper-button-next',
              prevEl: '.swiper-button-prev',
            },
          });
        } catch (e) {
          console.error("Error inicializando Swiper:", e);
        }

        // --- Selectores del Carrito ---
        const cartIcon = document.getElementById('cart-icon');
        const cartModal = document.getElementById('cart-modal');
        const cartModalContent = document.getElementById('cart-modal-content');
        const closeCartBtn = document.getElementById('close-cart-btn');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartTotalEl = document.getElementById('cart-total');
        const cartCountEl = document.getElementById('cart-count');
        const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
        const checkoutForm = document.getElementById('checkoutForm');
        const cartFormMessage = document.getElementById('cart-form-message');

        // --- Selectores del NUEVO Modal de Agradecimiento ---
        const thankYouModal = document.getElementById('thank-you-modal');
        const closeThankYouBtn = document.getElementById('close-thank-you-btn');
        const newOrderBtn = document.getElementById('new-order-btn');


        // --- Función para abrir y cerrar el modal de Carrito ---
        const openCartModal = () => {
          updateCartUI(); 
          cartModal.classList.remove('hidden');
          document.body.classList.add('modal-open'); 
        };
        
        const closeCartModal = () => {
            cartModal.classList.add('hidden');
            // No quitamos modal-open aquí, por si abrimos el de "gracias"
            // Se quitará al cerrar el último modal
        };

        // --- Función para abrir y cerrar el modal de Agradecimiento ---
        const showThankYouModal = () => {
            thankYouModal.classList.remove('hidden');
            document.body.classList.add('modal-open'); // Asegura que el body esté bloqueado
        };

        const closeThankYouModal = () => {
            thankYouModal.classList.add('hidden');
            document.body.classList.remove('modal-open'); // Desbloquea el body
        };
        
        // --- Event Listeners para Modales ---
        if (cartIcon) {
          cartIcon.addEventListener('click', openCartModal);
        }
        if (closeCartBtn) {
          closeCartBtn.addEventListener('click', closeCartModal);
        }
        if (cartModal) {
          cartModal.addEventListener('click', (e) => {
              if (e.target === cartModal) {
                  closeCartModal();
                  document.body.classList.remove('modal-open'); // Desbloquear si se cierra desde el fondo
              }
          });
        }
        
        // Listeners para el nuevo modal de "Gracias"
        if (closeThankYouBtn) {
          closeThankYouBtn.addEventListener('click', closeThankYouModal);
        }
        if (newOrderBtn) {
          newOrderBtn.addEventListener('click', closeThankYouModal); // Ambos botones cierran el modal
        }
        if (thankYouModal) {
          thankYouModal.addEventListener('click', (e) => {
              if (e.target === thankYouModal) {
                  closeThankYouModal();
              }
          });
        }

        // --- Función principal para actualizar la UI del Carrito ---
        const updateCartUI = () => {
            // Limpiar contenedor
            cartItemsContainer.innerHTML = '';
            
            let totalGeneral = 0;
            let totalItems = 0;

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-gray-500 text-center">Tu carrito está vacío.</p>';
            } else {
                cart.forEach(item => {
                    const subtotal = item.precio * item.cantidad;
                    totalGeneral += subtotal;
                    totalItems += item.cantidad;

                    const itemHTML = `
                        <div class="flex items-center justify-between gap-2 sm:gap-4 border-b pb-4">
                            <div class="flex-grow">
                                <h4 class="font-bold text-lg">${item.sabor}</h4>
                                <div class="flex items-center gap-2 mt-1">
                                    <label class="text-sm text-gray-600">Cant:</label>
                                    <div class="flex items-center border border-gray-300 rounded-lg">
                                        <button type="button" class="cart-quantity-btn cart-quantity-minus p-2 text-lg font-bold text-orange-600" data-sabor="${item.sabor}" data-change="-1">-</button>
                                        <input type="number" class="w-12 text-center border-none focus:ring-0 py-1 text-sm bg-transparent" value="${item.cantidad}" min="1" data-sabor="${item.sabor}" readonly>
                                        <button type="button" class="cart-quantity-btn cart-quantity-plus p-2 text-lg font-bold text-orange-600" data-sabor="${item.sabor}" data-change="1">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="text-right flex-shrink-0">
                                <span class="font-bold text-lg block">$${subtotal.toFixed(2)}</span>
                                <button class="remove-from-cart-btn text-red-500 text-sm hover:underline" data-sabor="${item.sabor}">Quitar</button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.innerHTML += itemHTML;
                });
            }

            // Actualizar totales
            cartTotalEl.textContent = `$${totalGeneral.toFixed(2)}`;
            cartCountEl.textContent = totalItems;
        };

        // --- Función para agregar al carrito ---
        const addToCart = (sabor, cantidad, precio, btn) => {
            const existingItem = cart.find(item => item.sabor === sabor);

            if (existingItem) {
                existingItem.cantidad += cantidad;
            } else {
                cart.push({ sabor, cantidad, precio });
            }

            updateCartUI(); // Actualiza el contador y el total

            // Mostrar mensaje de "¡Agregado!"
            const messageEl = btn.closest('.card-product').querySelector('.add-to-cart-message');
            if(messageEl) {
                messageEl.textContent = '¡Agregado!';
                setTimeout(() => {
                    messageEl.textContent = '';
                }, 2000); // Borra el mensaje después de 2 segundos
            }
        };

        // --- Asignar evento a botones "Agregar" ---
        // console.log(`Encontrados ${addToCartButtons.length} botones de "Agregar"`);
        addToCartButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                // console.log("Botón presionado:", btn.dataset.sabor);
                const card = btn.closest('.card-product');
                if (!card) {
                  // console.error("No se encontró '.card-product' padre");
                  return;
                }
                const sabor = btn.dataset.sabor;
                const precio = parseFloat(btn.dataset.precio);
                const cantidadInput = card.querySelector('.product-quantity');
                if (!cantidadInput) {
                  // console.error("No se encontró '.product-quantity'");
                  return;
                }
                const cantidad = parseInt(cantidadInput.value, 10);

                if (cantidad > 0) {
                    addToCart(sabor, cantidad, precio, btn);
                    cantidadInput.value = '1'; // Resetea la cantidad
                }
            });
        });

        // --- Asignar evento para botones del carrito (delegación) ---
        if (cartItemsContainer) {
          cartItemsContainer.addEventListener('click', (e) => {
              const target = e.target;
              
              // Botón "Quitar"
              if (target.classList.contains('remove-from-cart-btn')) {
                  const sabor = target.dataset.sabor;
                  cart = cart.filter(item => item.sabor !== sabor);
                  updateCartUI();
              } 
              
              // Botones + y -
              else if (target.classList.contains('cart-quantity-btn')) {
                  const sabor = target.dataset.sabor;
                  const change = parseInt(target.dataset.change, 10);
                  const cartItem = cart.find(item => item.sabor === sabor);
                  
                  if (cartItem) {
                      let newCantidad = cartItem.cantidad + change;
                      if (newCantidad > 0) {
                          cartItem.cantidad = newCantidad;
                      } else {
                          // Si es 0 o menos, quitarlo
                          cart = cart.filter(item => item.sabor !== sabor);
                      }
                      updateCartUI();
                  }
              }
          });
        }

        // --- Lógica de envío de formulario (checkoutForm) ---
        if (checkoutForm) {
          checkoutForm.addEventListener('submit', (e) => {
              e.preventDefault();

              if (cart.length === 0) {
                  cartFormMessage.textContent = 'Tu carrito está vacío. Agrega productos para confirmar.';
                  cartFormMessage.className = 'form-message error';
                  return;
              }

              const submitBtn = checkoutForm.querySelector('#submit-order-btn');
              const btnOriginalText = submitBtn.textContent;
              submitBtn.disabled = true;
              submitBtn.textContent = 'Enviando...';
              cartFormMessage.className = 'form-message'; 

              // Convertir el carrito al formato JSON
              const pedidos = cart.map(item => ({ 
                  sabor: item.sabor, 
                  cantidad: item.cantidad,
                  precio: item.precio 
              }));

              // Crear el objeto de datos
              const formData = {
                tipo: 'Pedido',
                nombre: checkoutForm.nombre.value,
                telefono: checkoutForm.telefono.value,
                pedido: JSON.stringify(pedidos),
                total: cartTotalEl.textContent, 
                lugarEntrega: checkoutForm['lugar-entrega'].value,
                comentarios: checkoutForm.comentarios.value
              };
              
              // Enviar a Google Apps Script
              fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', 
                cache: 'no-cache',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
              })
              .then(() => {
                  checkoutForm.reset();
                  cart = []; // Vacía el carrito
                  updateCartUI(); // Actualiza la UI (mostrará carrito vacío)
                  closeCartModal(); // Cierra el modal de *carrito*
                  
                  // ¡AQUÍ ESTÁ EL CAMBIO!
                  showThankYouModal(); // Mostramos el nuevo modal
                  
              })
              .catch(error => {
                  cartFormMessage.textContent = 'Hubo un error al enviar tu pedido. Intenta de nuevo.';
                  cartFormMessage.className = 'form-message error';
                  console.error('Error:', error);
              })
              .finally(() => {
                  submitBtn.disabled = false;
                  submitBtn.textContent = btnOriginalText;
              });
          });
        }

        // --- Lógica del Formulario de Reseñas ---
        const agregarNuevaReseña = (nombre, rating, comentario) => {
          const estrellasNum = parseInt(rating, 10) || 0;
          let estrellasIconos = '';
          if (estrellasNum > 0) {
            estrellasIconos = '★'.repeat(estrellasNum) + '☆'.repeat(5 - estrellasNum);
          }
          const safeNombre = nombre.replace(/</g, "&lt;").replace(/>/g, "&gt;");
          const safeComentario = comentario.replace(/</g, "&lt;").replace(/>/g, "&gt;");
          const nuevaReseñaHTML = `
            <div class="swiper-slide bg-white p-6 rounded-2xl shadow-xl">
              <div class="flex justify-between items-center mb-2">
                <span class="font-bold text-lg text-gray-800">${safeNombre}</span>
                <span class="text-amber-400 text-xl">${estrellasIconos}</span>
              </div>
              <p class="text-gray-600">${safeComentario}</p>
            </div>
          `;
          if (swiper) {
            swiper.appendSlide(nuevaReseñaHTML);
            swiper.update(); 
            swiper.slideTo(swiper.slides.length - 1); 
          }
        };

        if (reviewForm) {
          reviewForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const btnOriginalText = submitReviewBtn.textContent;
            submitReviewBtn.disabled = true;
            submitReviewBtn.textContent = 'Enviando...';
            reviewMessage.className = 'form-message'; 

            const rating = reviewForm.querySelector('input[name="rating"]:checked');
            const nombre = reviewForm['review-nombre'].value;
            const comentario = reviewForm['review-comentario'].value;
            const ratingValue = rating ? rating.value : '0';

            const formData = {
              tipo: 'Reseña',
              nombre: nombre,
              rating: ratingValue,
              comentario: comentario
            };

            fetch(SCRIPT_URL, {
              method: 'POST',
              mode: 'no-cors',
              cache: 'no-cache',
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(formData)
            })
            .then(() => {
                agregarNuevaReseña(nombre, ratingValue, comentario);
                reviewForm.reset();
                reviewMessage.textContent = '¡Gracias por tu reseña!';
                reviewMessage.className = 'form-message success';
            })
            .catch(error => {
                reviewMessage.textContent = 'Hubo un error al enviar tu reseña. Intenta de nuevo.';
                reviewMessage.className = 'form-message error';
                console.error('Error:', error);
            })
            .finally(() => {
                submitReviewBtn.disabled = false;
                submitReviewBtn.textContent = btnOriginalText;
            });
          });
        }

      });
    </script>

</body>
</html>


